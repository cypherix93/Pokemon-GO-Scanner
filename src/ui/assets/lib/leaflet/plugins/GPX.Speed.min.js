!function(){function t(t){var e="0123456789ABCDEF",n="";for(t=Math.floor(t);0!==t;)n=e[t%16]+n,t=Math.floor(t/16);for(;n.length<2;)n="0"+n;return n}function e(e){function n(e){return t(256*e)}return e<0?"#FF0000":e<1/3?"#FF"+n(3*e)+"00":e<2/3?"#"+n(2-3*e)+"FF00":e<1?"#00FF"+n(3*e-2):"#00FFFF"}function n(t){return 20!==t.length?new Date:new Date(t)}L.GPX.include({options:{maxSpeed:110,chunks:200},speedSplitEnable:function(t){return L.Util.setOptions(this,t),this.on("addline",this.speed_split,this)},speedSplitDisable:function(){return this.off("addline",this.speed_split,this)},speed_split:function(t){var i=t.line.pop(),o=i.getLatLngs(),l=Math.floor(o.length/this.options.chunks);l<3&&(l=3);for(var s=null,r=0;r<o.length;r+=l){var h=0,p=null;r+l>o.length&&(l=o.length-r);for(var a=0;a<l;a++)s&&(h+=s.distanceTo(o[r+a])),s=o[r+a],p||(p=n(s.meta.time));s=o[r+l-1],p=(n(s.meta.time)-p)/36e5;var u=.001*h/p,d=e(u/this.options.maxSpeed),f=new L.Polyline(o.slice(r,r+l+1),{color:d,weight:2,opacity:1});f.bindPopup("Dist: "+h.toFixed()+"m; Speed: "+u.toFixed(2)+" km/h"),t.line.push(f)}}})}();